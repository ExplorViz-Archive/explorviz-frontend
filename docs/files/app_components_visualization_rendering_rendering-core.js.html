<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app\components\visualization\rendering\rendering-core.js - ExplorViz: Frontend API</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-skin-sam">
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <h1 class="brand" style="padding: 10px 16px 10px; height: 20px; line-height: 20px; margin-left: 0;">
	    <img alt="ExplorViz: Frontend API" src="https://www.explorviz.net/img/favicon.png" style="max-height: 65%;" title="ExplorViz: Frontend API">
            ExplorViz: Frontend API
        </h1>
	<div class="nav">
            <li class="divider-vertical"></li>
            <li>
                <p class="navbar-text">
                    API Docs for Version: <b>0.0.2</b>
                </p>
            </li>
        </div>
        <form class="navbar-form pull-right" style="line-height: 40px; height: 40px;">
            <input style="margin-top: 0;" type="text" class="search-query" placeholder="Search for classes/modules..." data-obj='["classes/Administration-Route", "classes/AggregatedClazzCommunication-Model", "classes/Alertify-Handler", "classes/Application", "classes/Application-Controller", "classes/Application-Model", "classes/Application-Rendering-Component", "classes/Application-Route", "classes/Application-Serializer", "classes/ApplicationCommunication-Model", "classes/Authenticator", "classes/Authorizer", "classes/Badroute-Route", "classes/BaseEntity-Model", "classes/Clazz-Model", "classes/ClazzCommunication-Model", "classes/Component-Model", "classes/Configuration-Controller", "classes/Configuration-Route", "classes/Configuration-Service", "classes/CumulatedClazzCommunication-Model", "classes/Data-Reload-Service", "classes/DatabaseQuery-Model", "classes/Draw3DNodeEntity-Model", "classes/DrawEdgeEntity-Model", "classes/DrawNodeEntity-Model", "classes/Index-Route", "classes/Landscape-Adapter", "classes/Landscape-Model", "classes/Landscape-Reload-Service", "classes/Landscape-Rendering-Component", "classes/Landscape-Repository-Service", "classes/Landscape-Serializer", "classes/Login-Form-Component", "classes/Login-Route", "classes/Navbar-Glyphicons", "classes/Navbar-Routes", "classes/Node-Model", "classes/NodeGroup-Model", "classes/Page-Setup-Service", "classes/Rendering-Core-Component", "classes/Router", "classes/RuntimeInformation-Model", "classes/System-Model", "classes/System-Serializer", "classes/ThreeJS-Performance-Mixin", "classes/Time-Shift-Component", "classes/Timeshift-Reload-Service", "classes/Timestamp-Adapter", "classes/Timestamp-Model", "classes/Timestamp-Repository-Service", "classes/Tutorial-Route", "classes/user-Model", "classes/Visualization-Controller", "classes/Visualization-Route", "modules/explorviz", "modules/model", "modules/model.meta", "modules/model.util", "modules/network", "modules/page", "modules/security", "modules/settings", "modules/util", "modules/visualization", "modules/visualization.rendering", "modules/visualization.timeshift"]'>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span3">
	    <div>
	        <h3>APIs</h3>
	        <div id="sidebar">
	            <ul id="main-nav" class="nav nav-tabs" style="margin-bottom:0;">
	                <li class="active"><a href="#classes" data-toggle="tab">Classes</a></li>
	                <li><a href="#modules" data-toggle="tab">Modules</a></li>
	            </ul>
	    
	            <div id="api-tabview-filter">
	                <input type="search" placeholder="Type to filter APIs">
	            </div>
	    
	            <div class="tab-content" style="border: 1px solid #DDD; border-top:0;">
	                <div class="tab-pane active" id="classes">
	                    <ul id="api-classes" class="nav nav-list">
	                            <li><a href="../classes/Administration-Route.html">Administration-Route</a></li>
	                            <li><a href="../classes/AggregatedClazzCommunication-Model.html">AggregatedClazzCommunication-Model</a></li>
	                            <li><a href="../classes/Alertify-Handler.html">Alertify-Handler</a></li>
	                            <li><a href="../classes/Application.html">Application</a></li>
	                            <li><a href="../classes/Application-Controller.html">Application-Controller</a></li>
	                            <li><a href="../classes/Application-Model.html">Application-Model</a></li>
	                            <li><a href="../classes/Application-Rendering-Component.html">Application-Rendering-Component</a></li>
	                            <li><a href="../classes/Application-Route.html">Application-Route</a></li>
	                            <li><a href="../classes/Application-Serializer.html">Application-Serializer</a></li>
	                            <li><a href="../classes/ApplicationCommunication-Model.html">ApplicationCommunication-Model</a></li>
	                            <li><a href="../classes/Authenticator.html">Authenticator</a></li>
	                            <li><a href="../classes/Authorizer.html">Authorizer</a></li>
	                            <li><a href="../classes/Badroute-Route.html">Badroute-Route</a></li>
	                            <li><a href="../classes/BaseEntity-Model.html">BaseEntity-Model</a></li>
	                            <li><a href="../classes/Clazz-Model.html">Clazz-Model</a></li>
	                            <li><a href="../classes/ClazzCommunication-Model.html">ClazzCommunication-Model</a></li>
	                            <li><a href="../classes/Component-Model.html">Component-Model</a></li>
	                            <li><a href="../classes/Configuration-Controller.html">Configuration-Controller</a></li>
	                            <li><a href="../classes/Configuration-Route.html">Configuration-Route</a></li>
	                            <li><a href="../classes/Configuration-Service.html">Configuration-Service</a></li>
	                            <li><a href="../classes/CumulatedClazzCommunication-Model.html">CumulatedClazzCommunication-Model</a></li>
	                            <li><a href="../classes/Data-Reload-Service.html">Data-Reload-Service</a></li>
	                            <li><a href="../classes/DatabaseQuery-Model.html">DatabaseQuery-Model</a></li>
	                            <li><a href="../classes/Draw3DNodeEntity-Model.html">Draw3DNodeEntity-Model</a></li>
	                            <li><a href="../classes/DrawEdgeEntity-Model.html">DrawEdgeEntity-Model</a></li>
	                            <li><a href="../classes/DrawNodeEntity-Model.html">DrawNodeEntity-Model</a></li>
	                            <li><a href="../classes/Index-Route.html">Index-Route</a></li>
	                            <li><a href="../classes/Landscape-Adapter.html">Landscape-Adapter</a></li>
	                            <li><a href="../classes/Landscape-Model.html">Landscape-Model</a></li>
	                            <li><a href="../classes/Landscape-Reload-Service.html">Landscape-Reload-Service</a></li>
	                            <li><a href="../classes/Landscape-Rendering-Component.html">Landscape-Rendering-Component</a></li>
	                            <li><a href="../classes/Landscape-Repository-Service.html">Landscape-Repository-Service</a></li>
	                            <li><a href="../classes/Landscape-Serializer.html">Landscape-Serializer</a></li>
	                            <li><a href="../classes/Login-Form-Component.html">Login-Form-Component</a></li>
	                            <li><a href="../classes/Login-Route.html">Login-Route</a></li>
	                            <li><a href="../classes/Navbar-Glyphicons.html">Navbar-Glyphicons</a></li>
	                            <li><a href="../classes/Navbar-Routes.html">Navbar-Routes</a></li>
	                            <li><a href="../classes/Node-Model.html">Node-Model</a></li>
	                            <li><a href="../classes/NodeGroup-Model.html">NodeGroup-Model</a></li>
	                            <li><a href="../classes/Page-Setup-Service.html">Page-Setup-Service</a></li>
	                            <li><a href="../classes/Rendering-Core-Component.html">Rendering-Core-Component</a></li>
	                            <li><a href="../classes/Router.html">Router</a></li>
	                            <li><a href="../classes/RuntimeInformation-Model.html">RuntimeInformation-Model</a></li>
	                            <li><a href="../classes/System-Model.html">System-Model</a></li>
	                            <li><a href="../classes/System-Serializer.html">System-Serializer</a></li>
	                            <li><a href="../classes/ThreeJS-Performance-Mixin.html">ThreeJS-Performance-Mixin</a></li>
	                            <li><a href="../classes/Time-Shift-Component.html">Time-Shift-Component</a></li>
	                            <li><a href="../classes/Timeshift-Reload-Service.html">Timeshift-Reload-Service</a></li>
	                            <li><a href="../classes/Timestamp-Adapter.html">Timestamp-Adapter</a></li>
	                            <li><a href="../classes/Timestamp-Model.html">Timestamp-Model</a></li>
	                            <li><a href="../classes/Timestamp-Repository-Service.html">Timestamp-Repository-Service</a></li>
	                            <li><a href="../classes/Tutorial-Route.html">Tutorial-Route</a></li>
	                            <li><a href="../classes/user-Model.html">user-Model</a></li>
	                            <li><a href="../classes/Visualization-Controller.html">Visualization-Controller</a></li>
	                            <li><a href="../classes/Visualization-Route.html">Visualization-Route</a></li>
	                    </ul>
	                </div>
	    
	                <div class="tab-pane" id="modules">
	                    <ul id="api-modules" class="nav nav-list">
	                            <li><a href="../modules/explorviz.html">explorviz</a></li>
	                            <li><a href="../modules/model.html">model</a></li>
	                            <li><a href="../modules/model.meta.html">model.meta</a></li>
	                            <li><a href="../modules/model.util.html">model.util</a></li>
	                            <li><a href="../modules/network.html">network</a></li>
	                            <li><a href="../modules/page.html">page</a></li>
	                            <li><a href="../modules/security.html">security</a></li>
	                            <li><a href="../modules/settings.html">settings</a></li>
	                            <li><a href="../modules/util.html">util</a></li>
	                            <li><a href="../modules/visualization.html">visualization</a></li>
	                            <li><a href="../modules/visualization.rendering.html">visualization.rendering</a></li>
	                            <li><a href="../modules/visualization.timeshift.html">visualization.timeshift</a></li>
	                    </ul>
	                </div>
	            </div>
	        </div>
	    </div>
        </div>
        <div class="span9">
                <form id="options-form" class="form-inline pull-right">
                    Show:
                    <label for="api-show-inherited" class="checkbox">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected" class="checkbox">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private" class="checkbox">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated" class="checkbox">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </form>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<div class="page-header">
    <h1>app\components\visualization\rendering\rendering-core.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
import Ember from &#x27;ember&#x27;;
import THREE from &quot;npm:three&quot;;
import config from &#x27;explorviz-frontend/config/environment&#x27;;
import THREEPerformance from &#x27;explorviz-frontend/mixins/threejs-performance&#x27;;

const {Component, inject, Evented} = Ember;

/**
* This component contains the core mechanics of the different (three.js-based)
* renderer. All functions below are called in a determined order, hence you only
* need to override them in your custom renderer.
*
* See {{#crossLink &quot;Landscape-Rendering&quot;}}{{/crossLink}} or
* {{#crossLink &quot;Application-Rendering&quot;}}{{/crossLink}} for example usage.
*
* Call order:
*
* 1.
*
* @class Rendering-Core-Component
* @extends Ember.Component
*
* @module explorviz
* @submodule visualization.rendering
*/
export default Component.extend(Evented, THREEPerformance, {

  state: null,

  // Declare url-builder service
  urlBuilder: inject.service(&quot;url-builder&quot;),

  // Declare view-importer service
  viewImporter: inject.service(&quot;view-importer&quot;),

  reloadHandler: inject.service(&quot;reload-handler&quot;),
  landscapeRepo: inject.service(&quot;repos/landscape-repository&quot;),
  renderingService: inject.service(),

  classNames: [&#x27;viz&#x27;],

  scene : null,
  webglrenderer: null,
  camera: null,

  canvas: null,

  font: null,
  animationFrameId: null,

  initDone: false,

  appCondition: [],
  initImport: true,


  // @Override
  /**
   * This overridden Ember Component lifecycle hook enables calling
   * ExplorViz&#x27;s setup code for actual rendering and custom listeners.
   *
   * @method didRender
   */
  didRender(){
    this._super(...arguments);
    this.initRendering();
    this.initListener();
  },


  // @Override
  /**
   * This overridden Ember Component lifecycle hook enables calling
   * ExplorViz&#x27;s custom cleanup code.
   *
   * @method willDestroyElement
   */
  willDestroyElement() {
    this._super(...arguments);
    this.cleanup();
  },


  /**
   * This function is called once on the didRender event. Inherit this function
   * to call other important function, e.g. &quot;initInteraction&quot; as shown in
   * {{#crossLink &quot;Landscape-Rendering/initInteraction:method&quot;}}{{/crossLink}}.
   *
   * @method initRendering
   */
  initRendering() {

    this.debug(&#x27;init rendering-core&#x27;);

    const self = this;

    // get size if outer ember div
    const height = this.$()[0].clientHeight;
    const width = this.$()[0].clientWidth;

    const canvas = this.$(&#x27;#threeCanvas&#x27;)[0];

    this.set(&#x27;canvas&#x27;, canvas);

    this.set(&#x27;scene&#x27;, new THREE.Scene());
    this.set(&#x27;scene.background&#x27;, new THREE.Color(0xffffff));

    this.set(&#x27;camera&#x27;, new THREE.PerspectiveCamera(75, width / height, 0.1, 1000));

    this.set(&#x27;webglrenderer&#x27;, new THREE.WebGLRenderer({
      antialias: true,
      canvas: canvas
    }));
    this.get(&#x27;webglrenderer&#x27;).setPixelRatio(window.devicePixelRatio);
    this.get(&#x27;webglrenderer&#x27;).setSize(width, height);

    // Rendering loop //
    function render() {
      const animationId = requestAnimationFrame(render);
      self.set(&#x27;animationFrameId&#x27;, animationId);

      if(config.environment === &quot;development&quot; || config.environment === &quot;akr&quot;) {
        self.get(&#x27;threexStats&#x27;).update(self.get(&#x27;webglrenderer&#x27;));
        self.get(&#x27;stats&#x27;).begin();
      }

      self.get(&#x27;webglrenderer&#x27;).render(self.get(&#x27;scene&#x27;), self.get(&#x27;camera&#x27;));

      if(config.environment === &quot;development&quot; || config.environment === &quot;akr&quot;) {
        self.get(&#x27;stats&#x27;).end();
      }

    }

    render();

    ////////////////////

    // load font for labels and synchronously proceed with populating the scene
    new THREE.FontLoader()
      .load(&#x27;three.js/fonts/roboto_mono_bold_typeface.json&#x27;, function(font) {

      self.set(&#x27;font&#x27;, font);
      self.set(&#x27;initDone&#x27;, true);
      self.populateScene();
      // import new view
      self.importView();


    });

  },


  initListener() {

    const self = this;

    this.$(window).on(&#x27;resize.visualization&#x27;, function(){
      const outerDiv = this.$(&#x27;.viz&#x27;)[0];

      if(outerDiv) {

        const height = Math.round(this.$(&#x27;.viz&#x27;).height());
        const width = Math.round(this.$(&#x27;.viz&#x27;).width());

        self.set(&#x27;camera.aspect&#x27;, width / height);
        self.get(&#x27;camera&#x27;).updateProjectionMatrix();

        self.get(&#x27;webglrenderer&#x27;).setSize(width, height);

        self.onResized();
      }
    });


    this.get(&#x27;viewImporter&#x27;).on(&#x27;transmitView&#x27;, function(newState) {
        self.set(&#x27;newState&#x27;, newState);
    });


    this.get(&#x27;renderingService&#x27;).on(&#x27;reSetupScene&#x27;, function() {
      self.onReSetupScene();
    });


    this.get(&#x27;urlBuilder&#x27;).on(&#x27;requestURL&#x27;, function() {
      const state = {};

      // get timestamp
      state.timestamp = self.get(&#x27;landscapeRepo.latestLandscape&#x27;)
        .get(&#x27;timestamp&#x27;);

      // get latestApp, may be null
      const latestMaybeApp = self.get(&#x27;landscapeRepo.latestApplication&#x27;);
      state.appID = latestMaybeApp ? latestMaybeApp.get(&#x27;id&#x27;) : null;

      state.camX = self.get(&#x27;camera&#x27;).position.x;
      state.camY = self.get(&#x27;camera&#x27;).position.y;
      state.camZ = self.get(&#x27;camera&#x27;).position.z;

      if(state.appID){
        self.set(&#x27;appCondition&#x27;,[]);
        self.computeAppCondition(
          self.get(&#x27;landscapeRepo.latestApplication&#x27;).get(&#x27;components&#x27;),
          self.get(&#x27;landscapeRepo.latestApplication&#x27;).get(&#x27;clazzes&#x27;));
        state.appCondition = self.get(&#x27;appCondition&#x27;);
      }
      else{
        state.landscapeCondition = self.computeLandscapeCondition();
      }

      // Passes the state from component via service to controller
      self.get(&#x27;urlBuilder&#x27;).transmitState(state);
    });

    this.get(&#x27;landscapeRepo&#x27;).on(&quot;updated&quot;, function() {
      self.onUpdated();
    });

  },

  /*
   *  This method is used to collect data about the landscape.
   *  Ids of closed systems and nodegroups are stored in an array
   */
  computeLandscapeCondition(){

    const systems = this.get(&#x27;landscapeRepo.latestLandscape&#x27;).get(&#x27;systems&#x27;);
    const condition = [];

    systems.forEach(function(system) {

      let isRequestObject = false;

      // Find requests
      if (!isRequestObject &amp;&amp; system.get(&#x27;name&#x27;) === &quot;Requests&quot;) {
        isRequestObject = true;
      }
      // Exclude requests
      if(!isRequestObject){
        // Handle closed systems and add id to array
        if(!system.get(&#x27;opened&#x27;)){
          condition.push(system.get(&#x27;id&#x27;));
        }
        // Handle opened systems
        else{
          // Handle closed nodegroups and add id to array
          const nodegroups = system.get(&#x27;nodegroups&#x27;);
          nodegroups.forEach(function(nodegroup){
            if(!nodegroup.get(&#x27;opened&#x27;)){
              condition.push(nodegroup.get(&#x27;id&#x27;));
            }
          });
        }
      }
    });
    return condition;
  },

  /*
   *  This method is used to collect data about the application.
   *  Names of opened packages are stored in an array.
   *  Furthermore the name+highlighted of the
   *  highlighted package is stored
   */
  computeAppCondition(components, clazzes){
    const self = this;

    if(clazzes){
      clazzes.forEach(function(clazz) {
        if(clazz.get(&#x27;highlighted&#x27;)){
          self.get(&#x27;appCondition&#x27;).push(clazz.get(&#x27;name&#x27;).concat(&quot;highlighted&quot;));
        }
      });
    }

    components.forEach(function(component) {
      // Handle opened packages and add name to array
      if(component.get(&#x27;opened&#x27;)){
        self.get(&#x27;appCondition&#x27;).push(component.get(&#x27;name&#x27;));
        self.computeAppCondition(component.get(&#x27;children&#x27;), component.get(&#x27;clazzes&#x27;));
      }
      // Handle closed and highlighted packages
      else if(component.get(&#x27;highlighted&#x27;)){
        self.get(&#x27;appCondition&#x27;).push(component.get(&#x27;name&#x27;).concat(&quot;highlighted&quot;));
      }
    });
  },


  /*
   *  This method is used to open and close specified systems
   *  and nodegroups. The array &#x27;condition&#x27; contains the ids of
   *  of all closed systems and nodegroups
   */
  applyLandscapeCondition(landscape){

    const self = this;

    const systems = landscape.get(&#x27;systems&#x27;);

    systems.forEach(function(system) {
      let isRequestObject = false;

      if (!isRequestObject &amp;&amp; system.get(&#x27;name&#x27;) === &quot;Requests&quot;) {
        isRequestObject = true;
      }

      if(!isRequestObject){

        // Open system
        system.setOpened(true);
        for (var i = 0; i &lt; self.get(&#x27;condition&#x27;).length; i++) {

          // Close system if id is in condition
          if(parseFloat(system.get(&#x27;id&#x27;)) === parseFloat(self.get(&#x27;condition&#x27;)[i])){
            system.setOpened(false);
          }
        }

        // Check condition of nodegroups if system is opened
        if(system.get(&#x27;opened&#x27;)){
          const nodegroups = system.get(&#x27;nodegroups&#x27;);

          nodegroups.forEach(function(nodegroup) {

            // Open nodegroup
            nodegroup.setOpened(true);
            for (var i = 0; i &lt; self.get(&#x27;condition&#x27;).length; i++) {

              // Close nodegroup if id is in condition
              if(parseFloat(nodegroup.get(&#x27;id&#x27;)) === parseFloat(self.get(&#x27;condition&#x27;)[i])){
                nodegroup.setOpened(false);
              }
            }
          });
        }
      }
    });
  },

  applyAppCondition(application){

    const self = this;

    if(application){
      let components = null;
      if(self.get(&#x27;initImport&#x27;)){
        components = application.get(&#x27;components&#x27;);
        self.set(&#x27;initImport&#x27;, false);
      }
      else{
        components = application.get(&#x27;children&#x27;);
      }

      const clazzes = application.get(&#x27;clazzes&#x27;);

      if(clazzes){
        clazzes.forEach(function(clazz) {
          // Look for highlighted clazzes
          for (var i = 0; i &lt; self.get(&#x27;condition&#x27;).length; i++) {
            if(clazz.get(&#x27;name&#x27;).concat(&quot;highlighted&quot;) === self.get(&#x27;condition&#x27;)[i]) {
              clazz.set(&#x27;highlighted&#x27;,true);
            }
          }
        });
      }

      if(components){
        components.forEach(function(component) {
          // Close component
          component.setOpenedStatus(false);
          for (var i = 0; i &lt; self.get(&#x27;condition&#x27;).length; i++) {
            // Open component if name is in condition
            if(component.get(&#x27;name&#x27;) === self.get(&#x27;condition&#x27;)[i]){
              component.setOpenedStatus(true);
              self.applyAppCondition(component);
            }
            // case not opened =&gt; maybe highlighted
            else if(component.get(&#x27;name&#x27;).concat(&quot;highlighted&quot;) === self.get(&#x27;condition&#x27;)[i]) {
              component.set(&#x27;highlighted&#x27;,true);
            }
          }
        });
      self.cleanAndUpdateScene();
      }
    }
  },

  /**
    This method is used to update the camera with query parameters
  */
  importView(){

    const self = this;

    this.get(&#x27;viewImporter&#x27;).requestView();

    const camX = this.get(&#x27;newState&#x27;).camX;
    const camY = this.get(&#x27;newState&#x27;).camY;
    const camZ = this.get(&#x27;newState&#x27;).camZ;

    this.set(&#x27;condition&#x27;, this.get(&#x27;newState&#x27;).condition);

    if(!isNaN(camX)){
      this.get(&#x27;camera&#x27;).position.x = camX;
    }
    if(!isNaN(camY)){
      this.get(&#x27;camera&#x27;).position.y = camY;
    }
    if(!isNaN(camZ)){
      this.get(&#x27;camera&#x27;).position.z = camZ;
    }
    this.get(&#x27;camera&#x27;).updateProjectionMatrix();

    // load actual landscape
    const timestamp = this.get(&#x27;newState&#x27;).timestamp;
    const appID = this.get(&#x27;newState&#x27;).appID;

    if(timestamp) {
      self.get(&#x27;reloadHandler&#x27;).loadLandscapeById(timestamp, appID);
      waitForLandscape();
    }

    self.set(&#x27;initImport&#x27;,true);

    function waitForLandscape() {
      // New Promise
      var promise = new Ember.RSVP.Promise(
        function(resolve) {
          window.setTimeout(
            function() {
              // Wait until landscape is loaded
              if(self.get(&#x27;landscapeRepo.latestLandscape&#x27;) === null){
                waitForLandscape();
              }
              // Fulfill promise
              else if(self.get(&#x27;landscapeRepo.latestLandscape&#x27;)){
                resolve();
              }
            }, 500);
        });
      // Promise fulfilled =&gt; apply condition
      promise.then(
        function() {
          self.get(&#x27;reloadHandler&#x27;).stopExchange();
          if(appID){
            self.applyAppCondition(self.get(&#x27;landscapeRepo.latestApplication&#x27;));
          }
          else{
            self.applyLandscapeCondition(self.get(&#x27;landscapeRepo.latestLandscape&#x27;));
          }
        });
    }
  },

  /**
   * This function is called once on initRendering and everytime at the end of
   * &quot;cleanAndUpdateScene&quot;. Inherit this function to insert objects in the
   * Three.js scene. Have a look at
   * {{#crossLink &quot;Landscape-Rendering/cleanAndUpdateScene:method&quot;}}
   * {{/crossLink}}
   * or
   * {{#crossLink &quot;Application-Rendering/cleanAndUpdateScene:method&quot;}}
   * {{/crossLink}}
   * for examplary usage.
   *
   * @method populateScene
   */
  populateScene() {},


  /**
   * This function is called when the willDestroyElement event is fired. Inherit this
   * function to cleanup custom properties or unbind listener
   * as shown in {{#crossLink &quot;Landscape-Rendering&quot;}}{{/crossLink}}.
   *
   * @method cleanup
   */
  cleanup() {
    cancelAnimationFrame(this.get(&#x27;animationFrameId&#x27;));

    this.set(&#x27;scene&#x27;, null);
    this.set(&#x27;webglrenderer&#x27;, null);

    // clean up WebGL rendering context by forcing context loss
    var gl = this.get(&#x27;canvas&#x27;).getContext(&#x27;webgl&#x27;);
    gl.getExtension(&#x27;WEBGL_lose_context&#x27;).loseContext();

    this.set(&#x27;camera&#x27;, null);
    this.get(&#x27;urlBuilder&#x27;).off(&#x27;requestURL&#x27;);

    this.removePerformanceMeasurement();

    this.$(window).off(&#x27;resize.visualization&#x27;);
    this.get(&#x27;viewImporter&#x27;).off(&#x27;transmitView&#x27;);
    this.get(&#x27;renderingService&#x27;).off(&#x27;reSetupScene&#x27;);
    this.get(&#x27;landscapeRepo&#x27;).off(&#x27;updated&#x27;);
  },



  /**
   * Inherit this function to update the scene with a new renderingModel. It
   * automatically removes every mesh from the scene and finally calls
   * the (overridden) &quot;populateScene&quot; function. Add your custom code
   * as shown in landscape-rendering.
   *
   * @method cleanAndUpdateScene
   */
  cleanAndUpdateScene() {
    const scene = this.get(&#x27;scene&#x27;);

    removeAllChildren(scene);

    function removeAllChildren(entity) {
      for (let i = entity.children.length - 1; i &gt;= 0 ; i--) {
        let child = entity.children[i];

        removeAllChildren(child);

        if (child.type !== &#x27;AmbientLight&#x27; &amp;&amp; child.type !== &#x27;SpotLight&#x27; &amp;&amp; child.type !== &#x27;DirectionalLight&#x27;) {
          if(child.type !== &#x27;Object3D&#x27;) {
            child.geometry.dispose();
            child.material.dispose();
          }
          entity.remove(child);
        }
      }
    }
    this.populateScene();
  },


  /**
   * This function is called automatically when a new landscape was fetched. It
   * is executed before
   * {{#crossLink &quot;Rendering-Core/cleanAndUpdateScene:method&quot;}}{{/crossLink}}.
   * Inherit this function to preprocess the
   * {{#crossLink &quot;Landscape&quot;}}{{/crossLink}} for rendering, e.g. filter some
   * value.
   *
   * See {{#crossLink &quot;Application-Rendering&quot;}}{{/crossLink}} for example usage.
   *
   * @method preProcessEntity
   */
  preProcessEntity() {},





  // Listener-Callbacks. Override in extending components

  onReSetupScene() {
    this.cleanAndUpdateScene();
  },

  onUpdated() {
    this.cleanAndUpdateScene();
  },

  onResized() {
    this.cleanAndUpdateScene();
  }

});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script>prettyPrint();</script>
</body>
</html>
