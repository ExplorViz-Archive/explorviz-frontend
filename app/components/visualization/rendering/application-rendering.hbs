<div
  style="display:none"
  {{did-update this.onLandscapeUpdated @landscapeData}}
>
</div>

<div class="row" style="height:100%">
  <div
    class="d-flex {{if @showDataSelection "col-8" "col-12"}}"
    style="flex-direction: column; height: 100%"
  >
    <div
      id="rendering"
      {{did-insert this.outerDivInserted}}
      {{did-resize this.resize debounce=100}}
    >
      <canvas
        class="main-content-majority {{if this.hoveredObject "pointer-cursor"}}"
        {{interaction-modifier
          raycastObjects=this.applicationObject3D
          camera=this.camera
          hammerInteraction=this.hammerInteraction
          doubleClick=this.handleDoubleClick
          singleClick=this.handleSingleClick
          mouseMove=this.handleMouseMove
          mouseWheel=this.handleMouseWheel
          mouseOut=this.handleMouseOut
          mouseStop=this.handleMouseStop
          press=this.handlePress
        }}
        {{collaborative-modifier
          raycastObject3D=this.applicationObject3D
          camera=this.camera
          onSingleClick=this.singleClickOnMesh
          onDoubleClick=this.doubleClickOnMesh
          mouseMove=this.mouseMoveOnMesh
          mouseStop=this.mouseStopOnMesh
          mouseOut=this.handleMouseOut
          setPerspective=this.setPerspective
          repositionSphere=this.repositionSphere
        }}
        {{did-insert this.canvasInserted}}
      >
        {{#if this.hammerInteraction}}
          <RightClickMenuHammer
            @items={{this.rightClickMenuItems}}
            @hammer={{this.hammerInteraction}}
          />
        {{/if}}
      </canvas>
      {{#if this.loadNewApplication.isRunning}}
        <div
          class="position-absolute mt-6 pt-5 ml-3 pointer-events-none"
        >
          <Visualization::Rendering::LoadingIndicator @text="Loading New Application" />
        </div>
      {{/if}}

      {{!-- popup(s) --}}
      <Visualization::Rendering::Popups::PopupCoordinator
        @popupData={{this.popupData}}
      />
    </div>
  </div>
  {{#if @showDataSelection}}
    <div class="col-4" id="dataselection">
      <div class="mt-6 d-flex flex-row w-100">
        <Visualization::PageSetup::Sidebar::DataSelection
          @closeDataSelection={{@closeDataSelection}}
        >
          <div class="explorviz-visualization-navbar">
            <ul class="nav justify-content-center">
              <Visualization::PageSetup::Navbar::ColorPickerOpener
                @addComponent={{@addComponent}}
              />
              <Visualization::PageSetup::Navbar::TraceOverview
                @addComponent={{@addComponent}}
                @toggleVisualizationUpdating={{@toggleVisualizationUpdating}}
                @visualizationPaused={{@visualizationPaused}}
                @dynamicData={{@landscapeData.dynamicLandscapeData}}
              />
              <CollaborativeSettingsOpener
                @addComponent={{@addComponent}}
              />
            </ul>
          </div>
          {{#each @components as |componentName|}}
            <div class="card mt-3 border-radius-0">
              <div class="card-body d-flex flex-column">
                {{#if (eq componentName "trace-selection")}}
                  <h5 class="text-center">Trace Overview</h5>
                  <Visualization::PageSetup::Sidebar::TraceSelectionAndReplayer
                    @highlightTrace={{this.highlightTrace}}
                    @moveCameraTo={{this.moveCameraTo}}
                    @removeComponent={{@removeComponent}}
                    @removeHighlighting={{this.removeHighlighting}}
                    @dynamicData={{@landscapeData.dynamicLandscapeData}}
                    @structureData={{@landscapeData.structureLandscapeData}}
                    @application={{@landscapeData.application}}
                  />
                {{/if}}
                {{#if (eq componentName "color-picker")}}
                  <h5 class="text-center">Color Picker</h5>
                  <Visualization::PageSetup::Sidebar::ColorPicker
                    @isLandscapeView={{false}}
                    @removeComponent={{@removeComponent}}
                    @updateView={{this.updateColors}}
                  />
                {{/if}}
                {{#if (eq componentName "collaborative-settings")}}
                  <h5 class="text-center">Collaborative Settings</h5>
                  <CollaborativeSettings
                    @isLandscapeView={{true}}
                    @removeComponent={{@removeComponent}}
                    @updateView={{this.updateColors}}
                  />
                {{/if}}
              </div>
            </div>
          {{/each}}
        </Visualization::PageSetup::Sidebar::DataSelection>
      </div>
    </div>
  {{/if}}
</div>
